- config:
    name: 账号登录
    base_url: ${tiger_api_host()}        

- test:
    name: 用户名登录：用户名正确-密码正确
    api: api/account/account_login.yaml
    variables:
        - identity: ${source_user_username()}
        - password: ${source_user_password()}
    validate:
        - eq: [status_code, 200]
        - length_equals: [content, 4]
        - contains: [content, token]
    extract:
        - token: content.token

- test:
    name: 验证登录成功后获取用户信息
    request:
        method: GET
        url: /tiger/user
        headers:
            Authorization: Bearer $token
    validate:
        - eq: [status_code, 200]
        - eq: [content.id, '${source_user_id()}']
        - eq: [content.username, '${source_user_username()}']
        - length_equals: [content, 13]
