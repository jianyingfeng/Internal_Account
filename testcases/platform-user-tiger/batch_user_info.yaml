- config:
    name: 通过批量id获取用户信息
    request:
        base_url: $platform_tiger_api_host
        method: GET
    variables:
        - unexist_user_id: 100
        - wrong_type_user_ids: aaa
        - unsupport_fields_element: aaa
        - wrong_type_fields: '{}'

- test:
    name: 不传递user_ids-不传递fields
    request:
        url: /accounts
    validate:
        - eq: [status_code, 200]
        - length_equals: [content, 0]
        - type_match: [content, list]
- test:
    name: user_ids只包含存在用户-不传递fields
    request:
        url: /accounts?user_ids=[$source_user_id]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
        - length_equals: [content.0, 16]
        - contains: [content.0, bcmid]
        - contains: [content.0, nickname]
        - contains: [content.0, sex]
        - contains: [content.0, grade]
        - contains: [content.0, gold]
        - contains: [content.0, username]
        - contains: [content.0, email]
        - contains: [content.0, phone_number]
- test:
    name: user_ids只包含存在用户-fields为空数组
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=[]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
        - length_equals: [content.0, 16]
        - contains: [content.0, bcmid]
        - contains: [content.0, nickname]
        - contains: [content.0, sex]
        - contains: [content.0, grade]
        - contains: [content.0, gold]
        - contains: [content.0, username]
        - contains: [content.0, email]
        - contains: [content.0, phone_number]
- test:
    name: user_ids只包含存在用户-fields包含全部支持字段
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=["id", "bcmid", "nickname", "fullname", "avatar_url", "username", "email", "phone_number", "sex", "birthday", "description", "qq", "remark", "grade", "gold", "product_id"]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
        - length_equals: [content.0, 16]
        - contains: [content.0, bcmid]
        - contains: [content.0, nickname]
        - contains: [content.0, sex]
        - contains: [content.0, grade]
        - contains: [content.0, gold]
        - contains: [content.0, username]
        - contains: [content.0, email]
        - contains: [content.0, phone_number]
- test:
    name: user_ids只包含存在用户-fields只包含id
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=["id"]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
        - length_equals: [content.0, 1]
- test:
    name: user_ids只包含存在用户-fields只包含nickname
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=["nickname"]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
        - length_equals: [content.0, 2]
- test:
    name: user_ids只包含存在用户-fields只包含id和nickname
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=["id", "nickname"]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
        - length_equals: [content.0, 2]
- test:
    name: user_ids只包含存在用户-fields只包含不支持的字段
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=$unsupport_fields_element
    validate:
        - eq: [status_code, 400]
- test:
    name: user_ids只包含存在用户-fields格式错误
    request:
        url: /accounts?user_ids=[$source_user_id]&fields=$wrong_type_fields
    validate:
        - eq: [status_code, 400]
- test:
    name: user_ids包含存在用户和不存在用户
    request:
        url: /accounts?user_ids=[$source_user_id, $unexist_user_id]
    validate:
        - eq: [status_code, 200]
        - eq: [content.0.id, $source_user_id]
        - length_equals: [content, 1]
- test:
    name: user_ids只包含不存在用户
    request:
        url: /accounts?user_ids=[$unexist_user_id]
    validate:
        - eq: [status_code, 200]
        - length_equals: [content, 0]
- test:
    name: user_ids为空数组
    request:
        url: /accounts?user_ids=[]
    validate:
        - eq: [status_code, 400]
- test:
    name: user_ids格式错误
    request:
        url: /accounts?user_ids=$wrong_type_user_ids
    validate:
        - eq: [status_code, 400]