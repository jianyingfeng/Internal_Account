- config:
    name: 保存Box2.0作品（创建或者修改）
    base_url: ${tiger_api_host()}

- test:
    name: 已登录-创建Box2.0作品
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: 测试创建代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
    validate:
        - eq: [status_code, 200]
        - contains: [content, id]
        - type_match: [content.id, int]
    extract:
        - boxv2_work_id: content.id

- test:
    name: 已登录-创建Box2.0作品-name为空字符串
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: ''
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
    validate:
        - eq: [status_code, 400]
        - eq: [content.error_code, A_5]

- test:
    name: 已登录-创建Box2.0作品-name长度超过50位
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: '111111111111111111111111111111111111111111111111112'
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
    validate:
        - eq: [status_code, 400]
        - eq: [content.error_code, A_11]

- test:
    name: 已登录-更新Box2.0作品-work_id为个人Box2.0未发布作品
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: 测试修改代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
            work_id: $boxv2_work_id
    validate:
        - eq: [status_code, 200]
        - eq: [content.id, $boxv2_work_id]  

- test:
    name: 已登录-更新Box2.0作品-work_id为个人已发布IDE作品
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: 测试修改代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
            work_id: ${source_user_ide_published_work_id()}
    validate:
        - eq: [status_code, 404]
        - eq: [content.error_code, W_0]  

- test:
    name: 已登录-更新Box2.0作品-work_id为他人已发布Box2.0作品
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: 测试修改代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
            work_id: ${target_user_boxv2_published_work_id()}
    validate:
        - eq: [status_code, 403]
        - eq: [content.error_code, W_3]  

- test:
    name: 已登录-更新Box2.0作品-work_id为不存在的作品id(大于0)
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: 测试修改代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
            work_id: 100
    validate:
        - eq: [status_code, 404]
        - eq: [content.error_code, W_0]  

- test:
    name: 已登录-更新Box2.0作品-work_id为不存在的作品id(不大于0)
    request:
        method: POST
        url: /tiger/work/box
        headers:
            Authorization: ${source_user_login_token()}
        json: 
            name: 测试修改代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
            work_id: 0
    validate:
        - eq: [status_code, 404]
        - eq: [content.error_code, A_8]  

- test:
    name: 未登录-创建Box2.0作品
    request:
        method: POST
        url: /tiger/work/box
        json: 
            name: 测试创建代码岛2.0作品
            work_url: ${source_user_boxv2_work_url()}
            preview: ${source_user_boxv2_preview_url()}
            bcmc_url: ${source_user_boxv2_bcmc_url()}
    validate:
        - eq: [status_code, 403]
        - eq: [content.error_code, E_0]