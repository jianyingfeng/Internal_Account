- config:
    name: 获取某用户作品(Public)
    base_url: ${tiger_api_host()}
    variables:
        - unexist_user_id: 100
        - wrong_type_user_id: aaa
        - unexist_work_type_id: 100
        - wrong_type_work_type_id: aaa

- test:
    name: 未登录-用户有已发布IDE、Box1.0、Box2.0作品-type不传递
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}
    validate:
        - eq: [status_code, 200]
        - type_match: [content, list]
        - contained_by: [content.0.type, [1,3,5]]
        - length_equals: [content.0, 16]
        - contains: [content.0, type]
        - contains: [content.0, status]
        - contains: [content.0, praise_times]
        - contains: [content.0, view_times]
        - contains: [content.0, fork_times]

- test:
    name: 未登录-用户id不存在-type不传递
    request:
        method: GET
        url: /tiger/work/list/user/$unexist_user_id
    validate:
        - eq: [status_code, 200]
        - type_match: [content, list]
        - length_equals: [content, 0]

- test:
    name: 未登录-用户id格式错误-type不传递
    request:
        method: GET
        url: /tiger/work/list/user/$wrong_type_user_id
    validate:
        - eq: [status_code, 400]
        - eq: [content.error_code, A_5]

- test:
    name: 未登录-用户有已发布作品-type为1
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}?type=1
    validate:
        - eq: [status_code, 200]
        - type_match: [content, list]
        - length_equals: [content.0, 16]
        - contains: [content.0, type]
        - contains: [content.0, status]
        - contains: [content.0, praise_times]
        - contains: [content.0, view_times]
        - contains: [content.0, fork_times]

- test:
    name: 未登录-用户有已发布作品-type为7
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}?type=7
    validate:
        - eq: [status_code, 400]
        - eq: [content.error_code, A_5]

- test:
    name: 未登录-用户有已发布IDE、Box1.0、Box2.0作品-type为1,3,5
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}?type=1,3,5
    validate:
        - eq: [status_code, 200]
        - type_match: [content, list]
        - contained_by: [content.0.type, [1,3,5]]
        - length_equals: [content.0, 16]
        - contains: [content.0, type]
        - contains: [content.0, status]
        - contains: [content.0, praise_times]
        - contains: [content.0, view_times]
        - contains: [content.0, fork_times]

- test:
    name: 未登录-用户有已发布IDE、Box1.0、Box2.0作品-type不存在
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}?type=$unexist_work_type_id
    validate:
        - eq: [status_code, 400]
        - eq: [content.error_code, A_5]

- test:
    name: 未登录-用户有已发布IDE、Box1.0、Box2.0作品-type格式错误
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}?type=$wrong_type_work_type_id
    validate:
        - eq: [status_code, 400]
        - eq: [content.error_code, A_5]

- test:
    name: 已登录-user_id为当前用户-type不传递
    request:
        method: GET
        url: /tiger/work/list/user/${source_user_id()}
        headers:
            Authorization: ${source_user_login_token()}
    validate:
        - eq: [status_code, 200]
        - type_match: [content, list]
        - contained_by: [content.0.type, [1,3,5]]
        - length_equals: [content.0, 16]
        - contains: [content.0, type]
        - contains: [content.0, status]
        - contains: [content.0, praise_times]
        - contains: [content.0, view_times]
        - contains: [content.0, fork_times]

- test:
    name: 已登录-user_id不是当前用户-type不传递
    request:
        method: GET
        url: /tiger/work/list/user/${target_user_id()}
        headers:
            Authorization: ${source_user_login_token()}
    validate:
        - eq: [status_code, 200]
        - type_match: [content, list]